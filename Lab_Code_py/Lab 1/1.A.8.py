import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

Frequency =[100, 125, 160, 200, 250, 315, 400, 500, 630, 800, 1000, 1250, 1600, 2000, 2500, 3150, 4000, 5000, 6300, 8000, 10000, 12500, 16000, 20000, 25000, 31500, 40000, 50000, 63000, 80000, 100000]
Vrms_in = [3.444, 3.430,3.440, 3.438, 3.435, 3.436, 3.427, 3.419, 3.408, 3.394, 3.376, 3.356, 3.332, 3.311, 3.292, 3.277, 3.266, 3.259, 3.255, 3.252, 3.251, 3.252, 3.256, 3.256, 3.254, 3.254, 3.251, 3.250, 3.257, 3.251, 3.252]
Vrms_out = [3.418, 3.392, 3.398, 3.382,3.359, 3.334, 3.270, 3.198, 3.098, 2.940, 2.756, 2.532, 2.248, 1.978, 1.704, 1.440, 1.191, 0.989, 0.810, 0.656, 0.535, 0.437, 0.347, 0.282, 0.228, 0.184, 0.146, 0.119, 0.0977, 0.0786, 0.0650]


plt.figure()
plt.plot(Frequency, Vrms_in, color = "r")
plt.plot(Frequency, Vrms_out, color = "b")

plt.legend(["Vrms in", "Vrms out"])
plt.title("Plot of Vin and Vout rms vs. Frequency")
plt.xlabel("Frequency (Hz) ")
plt.ylabel("Voltage (V)")
plt.grid(True)

plt.show()


# --------------------------------------------------
plt.figure()

Vrms_in_np = np.array(Vrms_in)
Vrms_out_np = np.array(Vrms_out)

print(f"Length of Vrms_in: {len(Vrms_in)}")
print(f"Length of Vrms_out: {len(Vrms_out)}")


A_lp = Vrms_out_np/Vrms_in_np
print(A_lp)

data = np.column_stack((Frequency, Vrms_in, Vrms_out, A_lp))
df = pd.DataFrame(data, columns=['Frequency', 'Vrms_in', 'Vrms_out', 'A_lp'])

print(df.to_latex(index = False))

A_lp_db = 20 * np.log10(A_lp)

plt.semilogx(Frequency, A_lp_db)
plt.grid(True, which='both')

plt.xlabel('Frequency (Hz)')
plt.ylabel('Magnitude (dB)')
plt.title('Low-Pass Filter Frequency Response')

plt.show()

# ----------------------------------------
freq = [100, 104.712854805, 109.647819614, 114.81536215, 120.226443462, 125.892541179, 131.825673856, 138.03842646, 144.543977075, 151.356124844, 158.489319246, 165.958690744, 173.780082875, 181.970085861, 190.546071796, 199.526231497, 208.929613085, 218.776162395, 229.086765277, 239.883291902, 251.188643151, 263.02679919, 275.422870334, 288.403150313, 301.99517204, 316.227766017, 331.131121483, 346.736850453, 363.07805477, 380.189396321, 398.107170553, 416.86938347, 436.51583224, 457.088189615, 478.630092323, 501.187233627, 524.80746025, 549.540873858, 575.439937337, 602.559586074, 630.95734448, 660.693448008, 691.830970919, 724.435960075, 758.577575029, 794.328234724, 831.763771103, 870.963589956, 912.010839356, 954.992586021, 1000, 1047.12854805, 1096.47819614, 1148.1536215, 1202.26443462, 1258.92541179, 1318.25673856, 1380.3842646, 1445.43977075, 1513.56124844, 1584.89319246, 1659.58690744, 1737.80082875, 1819.70085861, 1905.46071796, 1995.26231497, 2089.29613085, 2187.76162395, 2290.86765277, 2398.83291902, 2511.88643151, 2630.2679919, 2754.22870334, 2884.03150313, 3019.9517204, 3162.27766017, 3311.31121483, 3467.36850453, 3630.7805477, 3801.89396321, 3981.07170553, 4168.6938347, 4365.1583224, 4570.88189615, 4786.30092323, 5011.87233627, 5248.0746025, 5495.40873858, 5754.39937337, 6025.59586074, 6309.5734448, 6606.93448008, 6918.30970919, 7244.35960075, 7585.77575029, 7943.28234724, 8317.63771103, 8709.63589956, 9120.10839356, 9549.92586021, 10000, 10471.2854805, 10964.7819614, 11481.536215, 12022.6443462, 12589.2541179, 13182.5673856, 13803.842646, 14454.3977075, 15135.6124844, 15848.9319246, 16595.8690744, 17378.0082875, 18197.0085861, 19054.6071796, 19952.6231497, 20892.9613085, 21877.6162395, 22908.6765277, 23988.3291902, 25118.8643151, 26302.679919, 27542.2870334, 28840.3150313, 30199.517204, 31622.7766017, 33113.1121483, 34673.6850453, 36307.805477, 38018.9396321, 39810.7170553, 41686.938347, 43651.583224, 45708.8189615, 47863.0092323, 50118.7233627, 52480.746025, 54954.0873858, 57543.9937337, 60255.9586074, 63095.734448, 66069.3448008, 69183.0970919, 72443.5960075, 75857.7575029, 79432.8234724, 83176.3771103, 87096.3589956, 91201.0839356, 95499.2586021, 100000]
channel_1db = [-0.244376712966,-0.244123386702, -0.244871957762, -0.243998777711, -0.245807433357, -0.245295344328, -0.246358802343, -0.246262224828, -0.246920417877, -0.247227021997, -0.247286629885, -0.246734314011, -0.249932504934, -0.250085133975, -0.251043408597, -0.252331152901, -0.253372610297, -0.253861559006, -0.255773462535, -0.256520249815, -0.258292405749, -0.258715243014, -0.261504879781, -0.262138847213, -0.263862871057, -0.266304078614, -0.267796337902, -0.269240433458, -0.274919192797, -0.275331212473, -0.278010733705, -0.281445544235, -0.284102753285, -0.288712818123, -0.290827290921, -0.29520559803, -0.301982260733, -0.305509560068, -0.310719729791, -0.317161640693, -0.322632651867, -0.329981398499, -0.335044146631, -0.342857686081, -0.349285403942, -0.358522433973, -0.366031651517, -0.375511543612, -0.383033105544, -0.392256311915, -0.402179992335, -0.412278916662, -0.422876420359, -0.433184370825, -0.443654739349, -0.454970771475, -0.465594511678, -0.477489538117, -0.490194137353, -0.502033255783, -0.511995916751, -0.525728115942, -0.535962179365, -0.547266475581, -0.558244686443, -0.56834446093, -0.57847215367, -0.589124738108, -0.596713721542, -0.606802310732, -0.616235953109, -0.629881003083, -0.635091378096, -0.640907561043, -0.649968549915, -0.654964930116, -0.662156126612, -0.679061302969, -0.673994045032, -0.679862684268, -0.684839508391, -0.692181617016, -0.702264101176, -0.709082643825, -0.712410804244, -0.710293243825, -0.706487392096, -0.709338461323, -0.711177300625, -0.711561073391, -0.723972829519, -0.715888456696, -0.716592821296, -0.722448782539, -0.716881952312, -0.719426239127, -0.721689435542, -0.721095401245, -0.729176201829, -0.71991901745, -0.722638912419, -0.719189940682, -0.721067891805, -0.720061513613, -0.71969684773, -0.736377938864, -0.719529368049, -0.719973420659, -0.725421375206, -0.722339329974, -0.718133425431, -0.71873141208, -0.71646521944, -0.716615393517, -0.715027833237, -0.715251608757, -0.713445939947, -0.713465667973, -0.713975619736, -0.716320972079, -0.726023167546, -0.713860908664, -0.712925571881, -0.71344594797, -0.711748013449, -0.714209266712, -0.713507118569, -0.715230608263, -0.714901068987, -0.717333166095, -0.723885752151, -0.731672254845, -0.72805202789, -0.731816988862, -0.731376581346, -0.728470435042, -0.721289252186, -0.725635722194, -0.724041375734, -0.724280987909, -0.729562954756, -0.730971497064, -0.729974024618, -0.733761697701, -0.733957406935, -0.737466740623, -0.736666880774, -0.748924922707, -0.741792455316, -0.740431983963, -0.748836877246,]
channel_2db = [-0.0606401772612, -0.0637078473314, -0.0671537941664, -0.0700652830089, -0.0732498159565, -0.0771522435187, -0.0818699380044, -0.0863233391725, -0.0909828512559, -0.0963874903049, -0.101777183439, -0.10790268161, -0.115303000083, -0.122296115107, -0.129637578082, -0.138231802746, -0.147005676289, -0.157405360363, -0.167677412833, -0.179976229127, -0.192401191552, -0.206227439133, -0.221070619686, -0.237597907335, -0.254652147449, -0.273514999324, -0.294124260941, -0.316393940658, -0.340679255159, -0.366659121092, -0.394926415187, -0.42601662803, -0.459386853025, -0.494475333406, -0.534099690242, -0.575857688788, -0.620363584693, -0.669514934568, -0.721990309269, -0.778856099535, -0.839382947754, -0.904820309515, -0.975150724107, -1.04992812801, -1.13161769086, -1.21790342267, -1.31026048585, -1.40899693785, -1.51511235966, -1.62723887786, -1.74607721856, -1.87121910579, -2.00457239317, -2.14542262034, -2.29360947732, -2.45062127417, -2.61462105233, -2.78550371632, -2.96475588754, -3.15132455698, -3.34669499107, -3.5500337152, -3.76039963757, -3.98060925712, -4.20648549327, -4.44167501128, -4.6833219011, -4.93261085915, -5.18458137127, -5.44702454938, -5.71719300076, -5.99082445632, -6.2690007167, -6.55431256345, -6.84687130513, -7.141573324, -7.44365549716, -7.74638397267, -8.05671297926, -8.37021721963, -8.68706538057, -9.00878230908, -9.33578078529, -9.66398148609, -9.99055945156, -10.3266026422, -10.6642440465, -11.0029695731, -11.3464311102, -11.6925226845, -12.0381935955, -12.3907004247, -12.7339951799, -13.089860038, -13.4467744257, -13.7991310362, -14.1557062487, -14.519829289, -14.8826435536, -15.2505096458, -15.6156479064, -15.9765687423, -16.3398329977, -16.7092317132, -17.0786319626, -17.439592279, -17.8157582595, -18.1843622742, -18.5573845416, -18.9307149368, -19.2939451306, -19.6758743685, -20.0472175619, -20.4229647534, -20.8112758162, -21.2000642946, -21.5706600476, -21.950284405, -22.3276691238, -22.7081289475, -23.0715656693, -23.4522810327, -23.8274138748, -24.2005004463, -24.5791138561, -24.9595713121, -25.3473519627, -25.7217756866, -26.1143684414, -26.4889374034, -26.8427458062, -27.2646968135, -27.6137860244, -27.998987477, -28.3560568191, -28.7119918362, -29.1036431523, -29.4367596027, -29.8123875038, -30.1984998984, -30.6114231891, -30.941334252, -31.2948964623, -31.6461853992, -32.0461560905, -32.3102972187, -32.7315199679, -33.0217400662, -33.3794721758, -33.6832321344, -34.0954090776,]

plt.figure()

plt.semilogx(Frequency, A_lp_db, marker='o')
plt.plot(freq, channel_2db, )
plt.grid(True, which='both')

plt.legend(["Frequency response from data points", "Network analyzer Frequency Response"])

plt.xlabel('Frequency (Hz)')
plt.ylabel('Voltage Gain (dB)')
plt.title('Low-Pass Filter Frequency Response')

plt.show()

plt.figure()

plt.semilogx(freq, channel_2db, )
plt.grid(True, which='both')
plt.title('Low-pass Filter Frequency Response from Network Analyzer')
plt.xlabel('Frequency (Hz)')
plt.ylabel('Voltage Gain (dB)')


plt.show()

